{"title":"SK-121-4G-AT任务分配","date":"2020-10-21T09:52:00.000Z","date_formatted":{"ll":"2020年10月21日","L":"2020/10/21","MM-DD":"10-21"},"author":"Sua-CQY","link":"2020/10/21/SK-121P-4G-AT任务分配","comments":true,"tags":["任务分配"],"updated":"2020-10-21T04:21:32.591Z","content":"<a id=\"more\"></a>\n\n<h2 id=\"一、说明\">一、说明<a href=\"#一、说明\" title=\"一、说明\"></a></h2><p>按代码的具体运行流程看代码，不懂的及时到<a href=\"https://wiki.openluat.com/\" target=\"_blank\">WIKI</a>或者是官网下载的LuaTask中的doc中查看相关的html文件的具体解析。从某个线程入手，要求掌握几点：</p>\n<ol><li>代码运行的顺序，代码大体框架（参考学习笔记2.0中的框架）；</li><li>每个线程的作用、各个线程之间的联系；</li><li>掌握基本学习方法，了解lua基本知识和用法；</li><li>掌握通用、可移植的基本代码；</li><li>按要求增添功能，调bug；</li><li>做好学习笔记、代码备注、版本说明。</li></ol><p>以下以线程的增减功能或测试功能来进一步学习，每个任务优先级从低到高，可以自行完成。有问题及时记录并提问。</p>\n<h2 id=\"二、线程一：ducr_test与test_mode\">二、线程一：ducr_test与test_mode<a href=\"#二、线程一：ducr_test与test_mode\" title=\"二、线程一：ducr_test与test_mode\"></a></h2><p>双核心测试线程，主要是开机初始化、模式检测及状态更新检测。需要完成的任务如下：</p>\n<ol><li>使用SecureCRT与LuaTools每5分钟打印一次以下几个参数：g_tts_default、nameValue、test_mode_state、record_state。</li><li>开机后播报完“欢迎使用本产品”后，再播放一句当前时间，格式为：年月日时分秒。</li><li>定时电压、信号检测并播报，播报后快闪三下。</li><li>将测试模式修改成：短按小键开始录音，短按大键播放当前电压、信号强度、版本信息、当前时间（格式为年月日），长按大键拨号10086，长按小键挂断，超过2分钟无操作退出测试模式。</li><li>添加一个线程，只要当进入测试模式时，无操作每隔30秒语音提醒“当前处于测试模式，请注意”，播放完毕慢闪2下，并发送一个数据包给服务器，数据包格式：</li></ol><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">{</span><br><span class=\"line\">​\t\"cmd\": \"SK121P_4G_AT_test\", </span><br><span class=\"line\"></span><br><span class=\"line\">​\t\"g\": \"xx“, </span><br><span class=\"line\"></span><br><span class=\"line\">​\t\"data\": {</span><br><span class=\"line\">\t\t\t\"time\": 1111111111,</span><br><span class=\"line\">\t\t    \"voltg\": 4000,</span><br><span class=\"line\">\t\t\t\"test_mode\":1</span><br><span class=\"line\">​\t        }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n<h2 id=\"三、线程二：p_call_check_state\">三、线程二：p_call_check_state<a href=\"#三、线程二：p_call_check_state\" title=\"三、线程二：p_call_check_state\"></a></h2><p>通话状态检测线程，主要作用为检测当前的通话状态。需要完成的任务如下：</p>\n<ol><li>使用SecureCRT与LuaTools每5分钟打印一次以下几个参数：g_call_time、hang_on、led_off、calling_table。</li><li>短按报时修改成：当前时间为xx，xx格式为：年月日时分秒。</li><li>定时电压、信号检测并播报，播报后快闪三下。</li><li>定时拨号给某个人，拨号如果成功结束播放“情况异常，汇报成功”，并慢闪两下，如果拨号失败，轮播白名单第7到第9个电话号码，直到接通为止，如果都没有接通，则汇报“情况异常，汇报失败，将三分钟后进行重拨”，定三分钟后重拨。</li><li>添加一个线程，通话记录四种状态：接通、未接、呼叫成功，呼叫失败，每个状态给单片机发送一个数据包，数据包要用到table相关用法，具体数据包定义如下：</li></ol><div class=\"φcz\"><div class=\"φdb\"><table><thead><tr>\n<th>通话状态</th><th>数据包类型</th></tr>\n</thead><tbody><tr>\n<td>接通</td><td>1A</td></tr>\n<tr>\n<td>未接</td><td>1B 2B</td></tr>\n<tr>\n<td>呼叫成功</td><td>3C</td></tr>\n<tr>\n<td>呼叫失败</td><td>4D</td></tr>\n</tbody></table></div></div><div class=\"φcz\"><div class=\"φdb\"><table><thead><tr>\n<th>包头</th><th>数据包类型</th><th>数据包长度</th><th>校验</th></tr>\n</thead><tbody><tr>\n<td>FF AA</td><td>1A(接通)</td><td>01</td><td>所有字节算术加取反</td></tr>\n</tbody></table></div></div><h2 id=\"四、时间安排\">四、时间安排<a href=\"#四、时间安排\" title=\"四、时间安排\"></a></h2><p>任务难度逐级递增，但是有相关代码作为参考，难度不算太大。按照当前课表以及学习进度，做以下规划：</p>\n<div class=\"φcz\"><div class=\"φdb\"><table><thead><tr>\n<th>日期</th><th>10.21</th><th>10.22</th><th>10.23</th><th>10.24</th><th>10.25</th></tr>\n</thead><tbody><tr>\n<td>任务一</td><td>完成</td><td></td><td></td><td></td><td></td></tr>\n<tr>\n<td>任务二</td><td></td><td>完成</td><td>完成</td><td></td><td></td></tr>\n<tr>\n<td>任务三</td><td></td><td></td><td>完成</td><td>完成</td><td></td></tr>\n<tr>\n<td>任务四</td><td></td><td></td><td></td><td>完成</td><td></td></tr>\n<tr>\n<td>任务五</td><td></td><td></td><td></td><td></td><td>完成</td></tr>\n</tbody></table></div></div><h2 id=\"五、其他\">五、其他<a href=\"#五、其他\" title=\"五、其他\"></a></h2><ol><li>记录问题及解决方法，重点知识要做笔记。</li><li>测试、编写有相关问题，先自行解决，没找到解决办法，可以发一下给我。</li><li>每天在群里汇报当天进度，任务是否完成，周三、周日汇报进度给杜老师，邮件抄送成员。</li></ol>","next":{"title":"有线电话通信原理及DTMF学习","link":"2020/08/15/有线电话通信原理及DTMF学习"},"plink":"http://yoursite.com/2020/10/21/SK-121P-4G-AT任务分配/"}